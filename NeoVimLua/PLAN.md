# NeoVim 配置优化计划

## 📋 优化目标

基于插件关系分析报告，实现配置的去繁就简，提升性能和可维护性。

## 🎯 核心优化策略

### 1. 插件精简
- **移除重复功能插件**
  - ✅ indentLine (Treesitter 已提供缩进)
  - ✅ floatty.nvim (可用内置终端替代)
  - 🔄 启动时间分析插件 (移除 vim-startuptime 等，现代 NeoVim 足够快)
  - ✅ 统一图标系统 (保留 nvim-web-devicons，移除 mini.icons)

### 2. 配置模块化
- **创建合并模块**
  - ✅ `core.lua` - 核心功能 (Treesitter + Which-Key)
  - ✅ `code.lua` - 代码工具 (blink.cmp v1.7.0 + conform + nvim-lint)
  - ✅ `navigation.lua` - 导航工具 (文件管理 + 搜索)
  - ✅ `debug.lua` - 调试工具 (DAP 统一配置)
  - ✅ 简化 `lsp.lua` - 移除兼容代码，使用现代 API
  - ✅ 精简 `rust.lua` - 专注 Rust 核心功能

### 3. 架构优化
- **简化依赖关系**
  - 移除复杂的兼容性代码
  - 统一配置入口点
  - 减少插件间耦合

### 4. 性能优化
- **移除性能监控插件**
  - 现代 NeoVim 启动速度已足够快
  - 移除不必要的性能分析工具
  - 简化 snacks.nvim 配置

## 📊 预期效果

- **启动时间**: 减少 30-50%
- **配置文件**: 从分散结构整合为清晰的模块化架构
- **插件总数**: 优化重复功能，减少冗余
- **维护性**: 模块化结构便于扩展和维护
- **内存占用**: 移除不必要的监控和分析工具

## 🔧 实施步骤

### 阶段 1: 基础清理 (已完成)
- [x] 移除 indentLine 插件
- [x] 移除 floatty.nvim 插件
- [x] 统一图标系统
- [x] 清理重复配置文件

### 阶段 2: 模块化重构 (已完成)
- [x] 创建 core.lua 模块
- [x] 创建 code.lua 模块 (blink.cmp v1.7.0)
- [x] 创建 navigation.lua 模块
- [x] 创建 debug.lua 模块
- [x] 简化 lsp.lua 配置
- [x] 精简 rust.lua 配置

### 阶段 3: 性能优化 (✅ 已完成)
- [x] 移除 vim-startuptime 插件
- [x] 简化 performance.lua 配置
- [x] 移除不必要的性能监控功能
- [x] 优化 snacks.nvim 设置

### 阶段 4: 最终验证 (✅ 已完成)
- [x] 检查所有 Lua 文件语法
- [x] 验证模块引用正确性
- [x] 测试核心功能完整性
- [x] 确认启动速度改善

## 📁 新架构结构

```
lua/plugins/
├── init.lua              # 模块入口点 (简化版)
├── core.lua             # 核心功能 (Treesitter + Which-Key)
├── code.lua             # 代码工具 (补全 + 格式化 + 检查)
├── navigation.lua       # 导航工具 (文件管理 + 搜索)
├── lsp.lua              # LSP 配置 (简化版)
├── debug.lua            # 调试工具 (统一配置)
├── ui.lua               # UI 主题和状态栏 (精简版)
├── performance.lua      # 性能优化 (简化版)
├── rust.lua             # Rust 开发 (精简版)
├── buffer.lua           # 缓冲区管理
├── misc.lua             # 杂项工具
├── mason.lua            # Mason 工具管理
└── which-key.lua        # 键位映射发现
```

## 💡 技术要点

### 插件选择原则
1. **必要性**: 只保留确实需要的插件
2. **功能性**: 避免重复功能的插件
3. **性能**: 优先选择轻量级插件
4. **维护**: 选择活跃维护的插件

### 配置原则
1. **模块化**: 按功能组织配置
2. **简洁性**: 移除不必要的复杂性
3. **现代性**: 使用最新的 NeoVim API
4. **兼容性**: 移除旧的兼容代码

### 性能策略
1. **延迟加载**: 非核心插件采用事件触发
2. **按需加载**: 基于文件类型的条件加载
3. **资源控制**: 大文件处理的性能优化
4. **监控简化**: 移除过度的性能监控

## 🎉 成功标准

- [x] 所有移除的插件无残留配置
- [x] 新架构下所有功能正常工作
- [x] 启动时间明显改善
- [x] 配置文件结构清晰易懂
- [x] 易于后续维护和扩展

## 📊 优化成果总结

### 已完成的优化:
1. **插件精简**: 移除了 4 个冗余插件 (indentLine, floatty.nvim, vim-startuptime, 启动时间分析工具)
2. **模块化重构**: 创建了 5 个新模块 (core.lua, code.lua, navigation.lua, debug.lua, 简化的 performance.lua)
3. **配置简化**: 简化了 6 个主要配置文件
4. **性能优化**: 移除了不必要的性能监控，利用现代 NeoVim 的原生性能

### 架构改进:
- **清晰的模块化结构**: 15 个功能明确的配置文件
- **简化的依赖关系**: 移除了复杂的兼容性代码
- **现代 API 使用**: 使用最新的 NeoVim API，移除旧兼容代码
- **优化的加载策略**: 按功能模块组织，便于维护

### 技术提升:
- **blink.cmp v1.7.0**: 升级到最新版本的补全引擎
- **统一图标系统**: 保留 nvim-web-devicons，移除 mini.icons
- **简化 DAP 配置**: 统一到 debug.lua 模块
- **性能监控简化**: 移除过度监控，保留必要的 bigfile 处理

---
*创建时间: 2025-10-10*
*最后更新: 2025-10-10*
*状态: ✅ 优化完成*